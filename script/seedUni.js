// scripts/seedUniversities.js

const mongoose = require("mongoose");
const City = require("../models/City");
const University = require("../models/University");

// Подключение к MongoDB Atlas (замени на правильную строку)
mongoose.connect(
  "mongodb+srv://nurrs:data@cluster0.njpnsaj.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0",
  {
    dbName: "test", // ⚠️ Замени на имя своей базы!
    useNewUrlParser: true,
    useUnifiedTopology: true,
  }
);

const data = {
  Астана: [
    "Назарбаев Университет",
    "Евразийский национальный университет им. Л.Н. Гумилёва",
    "Казахский национальный университет искусств",
    "Astana IT University",
  ],
  Алматы: [
    "Казахский национальный университет им. аль-Фараби",
    "Казахский национальный педагогический университет им. Абая",
    "Казахский национальный аграрный университет",
    "Казахский национальный технический университет им. К. Сатпаева",
    "Международный IT Университет",
    "Университет международного бизнеса (UIB)",
    "Казахстанский университет международных отношений и мировых языков им. Абылай хана",
    "Академия банковского дела",
  ],
  Шымкент: [
    "Южно-Казахстанский государственный университет им. М. О. Ауэзова",
    "Южно-Казахстанская медицинская академия",
    "Южно-Казахстанский педагогический университет им. Озбекали Жанибекова",
  ],
  Караганда: [
    "Карагандинский государственный университет им. Е. А. Букетова",
    "Карагандинский государственный медицинский университет",
    "Карагандинский государственный технический университет",
  ],
  Павлодар: [
    "Павлодарский государственный университет им. С. Торайгырова",
    "Павлодарский государственный педагогический институт",
  ],
  Семей: [
    "Государственный медицинский университет города Семей",
    "Семипалатинский государственный университет им. Шакарима",
  ],
  Актобе: [
    "Актюбинский региональный государственный университет им. К. Жубанова",
    "Западно-Казахстанский государственный медицинский университет им. М. Оспанова",
  ],
  Тараз: [
    "Таразский государственный университет им. М. Х. Дулати",
    "Таразский государственный педагогический институт",
  ],
  Кызылорда: ["Кызылординский университет им. Коркыт Ата"],
  "Усть-Каменогорск": [
    "Восточно-Казахстанский технический университет им. Д. Серикбаева",
    "Восточно-Казахстанский государственный университет им. С. Аманжолова",
  ],
  Костанай: [
    "Костанайский государственный университет им. А. Байтурсынова",
    "Костанайский государственный педагогический институт",
  ],
  Атырау: [
    "Атырауский государственный университет им. Х. Досмухамедова",
    "Атырауский университет нефти и газа",
  ],
  Уральск: [
    "Западно-Казахстанский аграрно-технический университет им. Жангир хана",
    "Западно-Казахстанский государственный университет им. М. Утемисова",
  ],
  Кокшетау: ["Кокшетауский государственный университет им. Ш. Уалиханова"],
  Талдыкорган: ["Жетысуский государственный университет им. И. Жансугурова"],
  Петропавловск: [
    "Северо-Казахстанский государственный университет им. М. Козыбаева",
  ],
  Актау: [
    "Каспийский государственный университет технологии и инжиниринга им. Ш. Есенова",
  ],
  Аркалык: [
    "Аркалыкский государственный педагогический институт им. И. Алтынсарина",
  ],
  Рудный: ["Рудненский индустриальный институт"],
  Темиртау: ["Карагандинский государственный индустриальный университет"],
  Туркестан: ["Международный казахско-турецкий университет им. Х. А. Ясави"],
};

async function seedUniversities() {
  try {
    for (const [cityName, universities] of Object.entries(data)) {
      const city = await City.findOne({ name: cityName });

      if (!city) {
        console.warn(`⚠️ Город "${cityName}" не найден в базе! Пропущен.`);
        continue;
      }

      for (const uni of universities) {
        await University.findOneAndUpdate(
          { name: uni },
          {
            name: uni,
            city: city._id,
            type: "Государственный", // можно кастомизировать, если есть частные
          },
          { upsert: true, new: true, setDefaultsOnInsert: true }
        );
      }
    }

    console.log("✅ Университеты успешно добавлены.");
  } catch (err) {
    console.error("❌ Ошибка при добавлении университетов:", err);
  } finally {
    mongoose.disconnect();
  }
}

seedUniversities();
